2024-06-11 19:03:50,006 - INFO - User registered: Mustafa
2024-06-12 11:17:28,256 - ERROR - Error deleting user: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 11:19:47,839 - ERROR - Error deleting user: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 11:34:33,909 - ERROR - Error deleting user: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 11:37:49,011 - ERROR - Error deleting user: (sqlite3.IntegrityError) NOT NULL constraint failed: orders.user_id
[SQL: UPDATE orders SET user_id=? WHERE orders.id = ?]
[parameters: (None, 1)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 11:40:19,314 - ERROR - Error deleting user: (sqlite3.IntegrityError) NOT NULL constraint failed: orders.user_id
[SQL: UPDATE orders SET user_id=? WHERE orders.id = ?]
[parameters: (None, 1)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 11:43:20,637 - ERROR - Error deleting user: Textual SQL expression 'DELETE FROM users WHERE i...' should be explicitly declared as text('DELETE FROM users WHERE i...')
2024-06-12 11:43:53,896 - ERROR - Error deleting user: Textual SQL expression 'DELETE FROM users WHERE i...' should be explicitly declared as text('DELETE FROM users WHERE i...')
2024-06-12 11:51:16,269 - ERROR - Error deleting user: Textual SQL expression 'DELETE FROM users WHERE i...' should be explicitly declared as text('DELETE FROM users WHERE i...')
2024-06-12 11:51:33,534 - ERROR - Error deleting user: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 11:53:06,202 - INFO - Attempting to delete user with ID 2.
2024-06-12 11:53:06,274 - INFO - User found: annah. Deleting...
2024-06-12 11:53:06,306 - ERROR - Error deleting user with ID 2: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 921, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: NOT NULL constraint failed: cart_items.user_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mustafa/project-phase-3/ecommerce.py", line 294, in delete_user
    session.commit()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2017, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1302, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1277, in _prepare_impl
    self.session.flush()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4341, in flush
    self._flush(objects)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4476, in _flush
    with util.safe_reraise():
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4437, in _flush
    flush_context.execute()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2353, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 921, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 11:53:10,174 - ERROR - Error deleting user: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 11:55:32,953 - INFO - Attempting to delete user with ID 2.
2024-06-12 11:55:33,032 - INFO - User found: annah. Deleting...
2024-06-12 11:55:33,063 - ERROR - Error deleting user with ID 2: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 921, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: NOT NULL constraint failed: cart_items.user_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mustafa/project-phase-3/ecommerce.py", line 294, in delete_user
    session.commit()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2017, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1302, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1277, in _prepare_impl
    self.session.flush()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4341, in flush
    self._flush(objects)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4476, in _flush
    with util.safe_reraise():
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4437, in _flush
    flush_context.execute()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2353, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 921, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 11:59:52,504 - INFO - Attempting to delete user with ID 2.
2024-06-12 11:59:52,579 - INFO - User found: annah. Deleting...
2024-06-12 11:59:52,614 - ERROR - Error deleting user with ID 2: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 921, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: NOT NULL constraint failed: cart_items.user_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mustafa/project-phase-3/ecommerce.py", line 294, in delete_user
    session.commit()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2017, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1302, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1277, in _prepare_impl
    self.session.flush()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4341, in flush
    self._flush(objects)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4476, in _flush
    with util.safe_reraise():
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4437, in _flush
    flush_context.execute()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2353, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 921, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: cart_items.user_id
[SQL: UPDATE cart_items SET user_id=? WHERE cart_items.id = ?]
[parameters: [(None, 1), (None, 2)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 12:03:35,658 - INFO - Attempting to delete user with ID 1.
2024-06-12 12:03:35,754 - INFO - User found: Mustafa. Deleting...
2024-06-12 12:03:35,796 - ERROR - Error deleting user with ID 1: (sqlite3.IntegrityError) NOT NULL constraint failed: orders.user_id
[SQL: UPDATE orders SET user_id=? WHERE orders.id = ?]
[parameters: (None, 1)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
sqlite3.IntegrityError: NOT NULL constraint failed: orders.user_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mustafa/project-phase-3/ecommerce.py", line 294, in delete_user
    session.commit()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2017, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1302, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1277, in _prepare_impl
    self.session.flush()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4341, in flush
    self._flush(objects)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4476, in _flush
    with util.safe_reraise():
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4437, in _flush
    flush_context.execute()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2353, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: orders.user_id
[SQL: UPDATE orders SET user_id=? WHERE orders.id = ?]
[parameters: (None, 1)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 12:07:54,389 - INFO - Attempting to delete user with ID 1.
2024-06-12 12:07:54,484 - INFO - User found: Mustafa. Deleting...
2024-06-12 12:07:54,486 - ERROR - Error deleting user with ID 1: Class 'builtins.int' is not mapped
Traceback (most recent call last):
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3523, in delete
    state = attributes.instance_state(instance)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'int' object has no attribute '_sa_instance_state'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mustafa/project-phase-3/ecommerce.py", line 293, in delete_user
    session.delete(user_id)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3525, in delete
    raise exc.UnmappedInstanceError(instance) from err
sqlalchemy.orm.exc.UnmappedInstanceError: Class 'builtins.int' is not mapped
2024-06-12 12:10:32,975 - ERROR - Error deleting user with ID 1: (sqlite3.IntegrityError) NOT NULL constraint failed: orders.user_id
[SQL: UPDATE orders SET user_id=? WHERE orders.id = ?]
[parameters: (None, 1)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
sqlite3.IntegrityError: NOT NULL constraint failed: orders.user_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mustafa/project-phase-3/ecommerce.py", line 290, in delete_user
    session.commit()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2017, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1302, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1277, in _prepare_impl
    self.session.flush()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4341, in flush
    self._flush(objects)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4476, in _flush
    with util.safe_reraise():
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4437, in _flush
    flush_context.execute()
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        ^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2353, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/home/mustafa/.pyenv/versions/3.11.0/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 924, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: orders.user_id
[SQL: UPDATE orders SET user_id=? WHERE orders.id = ?]
[parameters: (None, 1)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-06-12 12:13:30,344 - WARNING - User with ID 13 not found.
